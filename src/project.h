#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>
#include <sys/wait.h>
#include <math.h>
#include <fcntl.h>
#include <string.h>
#include <time.h>
#include "io.h"
#include "weather.h"
#include "emoticon.h"

#define MODE_UNCHANGED 0

#define MODE_CLOCK 10
#define MODE_WEATHER 11
#define MODE_TIMER 12



#define True 1
#define False 0

int isModeChanged(unsigned char currentMode, int TS_input);
void TimerFunction(int TS_input);
void WeatherFunction(int TS_input);
void ClockFunction(int TS_input);
void GetWeatherAsync();

//맑음1
// Point SUNNY_1[60] = {{.X = 0, .Y = 1}, {.X = 0, .Y = 2}, {.X = 0, .Y = 3}, {.X = 0, .Y = 4}, {.X = 0, .Y = 5}, {.X = 0, .Y = 6}, {.X = 1, .Y = 0}, {.X = 1, .Y = 1}, {.X = 1, .Y = 2}, {.X = 1, .Y = 3}, {.X = 1, .Y = 4}, {.X = 1, .Y = 5}, {.X = 1, .Y = 6}, {.X = 1, .Y = 7}, {.X = 2, .Y = 0}, {.X = 2, .Y = 1}, {.X = 2, .Y = 2}, {.X = 2, .Y = 3}, {.X = 2, .Y = 4}, {.X = 2, .Y = 5}, {.X = 2, .Y = 6}, {.X = 2, .Y = 7}, {.X = 3, .Y = 0}, {.X = 3, .Y = 1}, {.X = 3, .Y = 2}, {.X = 3, .Y = 3}, {.X = 3, .Y = 4}, {.X = 3, .Y = 5}, {.X = 3, .Y = 6}, {.X = 3, .Y = 7}, {.X = 4, .Y = 0}, {.X = 4, .Y = 1}, {.X = 4, .Y = 2}, {.X = 4, .Y = 3}, {.X = 4, .Y = 4}, {.X = 4, .Y = 5}, {.X = 4, .Y = 6}, {.X = 4, .Y = 7}, {.X = 5, .Y = 0}, {.X = 5, .Y = 1}, {.X = 5, .Y = 2}, {.X = 5, .Y = 3}, {.X = 5, .Y = 4}, {.X = 5, .Y = 5}, {.X = 5, .Y = 6}, {.X = 5, .Y = 7}, {.X = 6, .Y = 0}, {.X = 6, .Y = 1}, {.X = 6, .Y = 2}, {.X = 6, .Y = 3}, {.X = 6, .Y = 4}, {.X = 6, .Y = 5}, {.X = 6, .Y = 6}, {.X = 6, .Y = 7}, {.X = 7, .Y = 1}, {.X = 7, .Y = 2}, {.X = 7, .Y = 3}, {.X = 7, .Y = 4}, {.X = 7, .Y = 5}, {.X = 7, .Y = 6}};
// //맑음2
// Point SUNNY_2[32] = {{.X = 1, .Y = 2}, {.X = 1, .Y = 3}, {.X = 1, .Y = 4}, {.X = 1, .Y = 5}, {.X = 2, .Y = 1}, {.X = 2, .Y = 2}, {.X = 2, .Y = 3}, {.X = 2, .Y = 4}, {.X = 2, .Y = 5}, {.X = 2, .Y = 6}, {.X = 3, .Y = 1}, {.X = 3, .Y = 2}, {.X = 3, .Y = 3}, {.X = 3, .Y = 4}, {.X = 3, .Y = 5}, {.X = 3, .Y = 6}, {.X = 4, .Y = 1}, {.X = 4, .Y = 2}, {.X = 4, .Y = 3}, {.X = 4, .Y = 4}, {.X = 4, .Y = 5}, {.X = 4, .Y = 6}, {.X = 5, .Y = 1}, {.X = 5, .Y = 2}, {.X = 5, .Y = 3}, {.X = 5, .Y = 4}, {.X = 5, .Y = 5}, {.X = 5, .Y = 6}, {.X = 6, .Y = 2}, {.X = 6, .Y = 3}, {.X = 6, .Y = 4}, {.X = 6, .Y = 5}};

// //구름많음1
// Point CLOUDY_1[19] = {{.X = 0, .Y = 0}, {.X = 0, .Y = 1}, {.X = 0, .Y = 6}, {.X = 1, .Y = 0}, {.X = 1, .Y = 5}, {.X = 2, .Y = 4}, {.X = 2, .Y = 5}, {.X = 3, .Y = 5}, {.X = 3, .Y = 6}, {.X = 4, .Y = 6}, {.X = 4, .Y = 7}, {.X = 4, .Y = 1}, {.X = 4, .Y = 2}, {.X = 5, .Y = 0}, {.X = 5, .Y = 1}, {.X = 5, .Y = 2}, {.X = 5, .Y = 3}, {.X = 6, .Y = 1}, {.X = 6, .Y = 2}};
// //구름많음2
// Point CLOUDY_2[18] = {{.X = 0, .Y = 0}, {.X = 0, .Y = 1}, {.X = 0, .Y = 2}, {.X = 0, .Y = 3}, {.X = 1, .Y = 1}, {.X = 1, .Y = 2}, {.X = 1, .Y = 7}, {.X = 2, .Y = 6}, {.X = 2, .Y = 7}, {.X = 3, .Y = 7}, {.X = 4, .Y = 3}, {.X = 4, .Y = 4}, {.X = 5, .Y = 2}, {.X = 5, .Y = 3}, {.X = 5, .Y = 4}, {.X = 5, .Y = 5}, {.X = 6, .Y = 3}, {.X = 6, .Y = 4}};

// // //흐림1
// // Point asdf1[4] = {{.X = 0, .Y = 5}, {.X = 0, .Y = 6},
// // {.X = 1, .Y = 1}, {.X = 1, .Y = 2}, {.X = 1, .Y = 4}, {.X = 1, .Y = 5}, {.X = 1, .Y = 6}, {.X = 1, .Y = 7},
// //  {.X = 2, .Y = 0}, {.X = 2, .Y = 1}, {.X = 2, .Y = 2}, {.X = 2, .Y = 3}, {.X = 2, .Y = 5}, {.X = 2, .Y = 6},
// //  {.X = 3, .Y = 1}, {.X = 3, .Y = 2},
// //  {.X = 4, .Y = 4}, {.X = 4, .Y = 5},
// //  {.X = 5, .Y = 3}, {.X = 5, .Y = 4}, {.X = 5, .Y = 5}, {.X = 5, .Y = 6},
// //  {.X = 6, .Y = 0}, {.X = 6, .Y = 1}, {.X = 6, .Y = 4}, {.X = 6, .Y = 5},
// //  {.X = 7, .Y = 0}, {.X = 7, .Y = 1}, {.X = 7, .Y = 2}, {.X = 7, .Y = 7}};
// // //흐림2
// // Point asdf2[5] = {{.X = 0, .Y = 0}, {.X = 0, .Y = 1}, {.X = 0, .Y = 7},
// // {.X = 1, .Y = 3}, {.X = 1, .Y = 4}, {.X = 1, .Y = 6}, {.X = 1, .Y = 7},
// // {.X = 2, .Y = 2}, {.X = 2, .Y = 3}, {.X = 2, .Y = 4}, {.X = 2, .Y = 5}, {.X = 2, .Y = 7},
// // {.X = 3, .Y = 0}, {.X = 3, .Y = 3}, {.X = 3, .Y = 4},
// // {.X = 4, .Y = 0}, {.X = 4, .Y = 1}, {.X = 4, .Y = 6}, {.X = 4, .Y = 7},
// // {.X = 5, .Y = 0}, {.X = 5, .Y = 5}, {.X = 5, .Y = 6}, {.X = 5, .Y = 7},
// // {.X = 6, .Y = 2}, {.X = 6, .Y = 3}, {.X = 6, .Y = 6}, {.X = 6, .Y = 7},
// // {.X = 7, .Y = 1}, {.X = 7, .Y = 2}, {.X = 7, .Y = 3}, {.X = 7, .Y = 4}};

// //비1
// Point RAIN_1[20] = {{.X = 0, .Y = 0}, {.X = 0, .Y = 1}, {.X = 0, .Y = 4}, {.X = 0, .Y = 5}, {.X = 0, .Y = 6}, {.X = 2, .Y = 2}, {.X = 2, .Y = 3}, {.X = 2, .Y = 5}, {.X = 2, .Y = 6}, {.X = 2, .Y = 7}, {.X = 4, .Y = 0}, {.X = 4, .Y = 1}, {.X = 4, .Y = 4}, {.X = 4, .Y = 5}, {.X = 4, .Y = 6}, {.X = 6, .Y = 2}, {.X = 6, .Y = 3}, {.X = 6, .Y = 5}, {.X = 6, .Y = 6}, {.X = 6, .Y = 7}};

// //비2
// Point RAIN_2[20] = {{.X = 1, .Y = 0}, {.X = 1, .Y = 1}, {.X = 1, .Y = 4}, {.X = 1, .Y = 5}, {.X = 1, .Y = 6}, {.X = 3, .Y = 2}, {.X = 3, .Y = 3}, {.X = 3, .Y = 5}, {.X = 3, .Y = 6}, {.X = 3, .Y = 7}, {.X = 5, .Y = 0}, {.X = 5, .Y = 1}, {.X = 5, .Y = 4}, {.X = 5, .Y = 5}, {.X = 5, .Y = 6}, {.X = 7, .Y = 2}, {.X = 7, .Y = 3}, {.X = 7, .Y = 5}, {.X = 7, .Y = 6}, {.X = 7, .Y = 7}};

// //비&눈1
// Point RAIN_SNOW_1[19] = {{.X = 0, .Y = 0}, {.X = 0, .Y = 1}, {.X = 0, .Y = 4}, {.X = 0, .Y = 5}, {.X = 0, .Y = 6}, {.X = 2, .Y = 3}, {.X = 2, .Y = 6}, {.X = 2, .Y = 7}, {.X = 3, .Y = 2}, {.X = 3, .Y = 3}, {.X = 3, .Y = 4}, {.X = 4, .Y = 0}, {.X = 4, .Y = 1}, {.X = 4, .Y = 3}, {.X = 6, .Y = 2}, {.X = 6, .Y = 3}, {.X = 6, .Y = 5}, {.X = 6, .Y = 6}, {.X = 6, .Y = 7}};

// //비&눈2

// Point RAIN_SNOW_2[19] = {{.X = 1, .Y = 0}, {.X = 1, .Y = 1}, {.X = 1, .Y = 4}, {.X = 1, .Y = 5}, {.X = 1, .Y = 6}, {.X = 3, .Y = 4}, {.X = 3, .Y = 6}, {.X = 3, .Y = 7}, {.X = 4, .Y = 3}, {.X = 4, .Y = 4}, {.X = 4, .Y = 5}, {.X = 5, .Y = 0}, {.X = 5, .Y = 1}, {.X = 5, .Y = 4}, {.X = 7, .Y = 2}, {.X = 7, .Y = 3}, {.X = 7, .Y = 5}, {.X = 7, .Y = 6}, {.X = 7, .Y = 7}};

// //눈1
// Point SNOW_1[15] = {{.X = 0, .Y = 1},
//                     {.X = 1, .Y = 0},
//                     {.X = 1, .Y = 1},
//                     {.X = 1, .Y = 2},
//                     {.X = 2, .Y = 1},
//                     {.X = 2, .Y = 6},
//                     {.X = 3, .Y = 5},
//                     {.X = 3, .Y = 6},
//                     {.X = 3, .Y = 7},
//                     {.X = 4, .Y = 6},
//                     {.X = 5, .Y = 2},
//                     {.X = 6, .Y = 1},
//                     {.X = 6, .Y = 2},
//                     {.X = 6, .Y = 3},
//                     {.X = 7, .Y = 2}};

// //눈2
// Point SNOW_2[14] = {
//     {.X = 1, .Y = 2},
//     {.X = 2, .Y = 1},
//     {.X = 2, .Y = 2},
//     {.X = 2, .Y = 3},
//     {.X = 3, .Y = 2},
//     {.X = 3, .Y = 7},
//     {.X = 4, .Y = 6},
//     {.X = 4, .Y = 7},
//     {.X = 5, .Y = 4},
//     {.X = 5, .Y = 7},
//     {.X = 6, .Y = 3},
//     {.X = 6, .Y = 4},
//     {.X = 6, .Y = 5},
//     {.X = 7, .Y = 4},
// };

// Points EMOTICONS[10] = {{.points = SUNNY_1, .len = 60}, {.points = SUNNY_2, .len = 32}, {.points = CLOUDY_1, .len = 19}, {.points = CLOUDY_2, .len = 18}, {.points = RAIN_1, .len = 20}, {.points = RAIN_2, .len = 20}, {.points = RAIN_SNOW_1, .len = 19}, {.points = RAIN_SNOW_2, .len = 19}, {.points = SNOW_1, .len = 15}, {.points = SNOW_2, .len = 14}};